package v1

import (
	"bytes"
	"encoding/json"
	"fmt"
	"io"
	"net/http"
	"regexp"
	"strings"
	"time"

	"github.com/gofiber/fiber/v2"

	"github.com/spf13/viper"
	"go.uber.org/zap"
)

// yandexQuestions handles the processing of a Yandex questions request.
//
// c: Context provided by Fiber framework.
// error: An error interface.
func yandexQuestions(c *fiber.Ctx) error {
	apiKey := viper.GetString("yandex.api_key")
	folderId := viper.GetString("yandex.folder_id")

	var requestBody RequestBody

	if err := c.BodyParser(&requestBody); err != nil {
		zap.S().Debugln(err)
		return c.Status(fiber.StatusBadRequest).JSON(err)
	}

	if requestBody.HumanInfo.Sex == "" {
		return c.Status(fiber.StatusBadRequest).JSON(fiber.Map{
			"error": "sex query param is required",
		})
	}

	if requestBody.HumanInfo.Name == "" {
		return c.Status(fiber.StatusBadRequest).JSON(fiber.Map{
			"error": "name query param is required",
		})
	}

	if requestBody.HumanInfo.DateOfBirth == "" {
		return c.Status(fiber.StatusBadRequest).JSON(fiber.Map{
			"error": "date_of_birth query param is required",
		})
	}

	USER_PROMPT = USER_PROMPT_QUESTIONS + " человека " + requestBody.HumanInfo.Sex + " пола " + "  по имени " + requestBody.HumanInfo.Name + "," + " дата рождения " + requestBody.HumanInfo.DateOfBirth + SYSTEM_PROMPT_QUESTIONS_FORMAT

	extraContext := []struct {
		Role string
		Text string
	}{
		{
			Role: "system",
			Text: "Какой самый яркий момент из жизни Валерия Вам запомнился?",
		},
		{
			Role: "user",
			Text: "Яркий момент: Спасение человека в критической ситуации.",
		},
		{
			Role: "system",
			Text: "Что Валерий ценил больше всего в друзьях?",
		},
		{
			Role: "user",
			Text: "Честность и надёжность.",
		},
		{
			Role: "system",
			Text: "Какие увлечения были у Валерия?",
		},
		{
			Role: "user",
			Text: "Исторические романы и путешествия.",
		},
		{
			Role: "system",
			Text: "Какие черты характера делали Валерия особенным?",
		},
		{
			Role: "user",
			Text: "Иронический ум и доброта.",
		},
		{
			Role: "system",
			Text: "О чём Валерий любил рассказывать?",
		},
		{
			Role: "user",
			Text: "О своих путешествиях и открытиях.",
		},
		{
			Role: "system",
			Text: "Какой совет Валерий дал бы молодым?",
		},
		{
			Role: "user",
			Text: "Делайте добро.",
		},
		{
			Role: "system",
			Text: "Какие слова или фразы чаще всего говорил Илья?",
		},
		{
			Role: "user",
			Text: "Всё получится!",
		},
		{
			Role: "system",
			Text: "Какие моменты из детства Ильи Вам известны?",
		},
		{
			Role: "user",
			Text: "Исследования природы родного города.",
		},
		{
			Role: "system",
			Text: "Чем Илья любил заниматься в свободное время?",
		},
		{
			Role: "user",
			Text: "Садоводство и научная фантастика.",
		},
		{
			Role: "system",
			Text: "Какой смешной случай из жизни Ильи Вы можете вспомнить?",
		},
		{
			Role: "user",
			Text: "Забыл очки на вершине горы.",
		},
		{
			Role: "system",
			Text: "Какие качества Ильи восхищали его друзей и близких?",
		},
		{
			Role: "user",
			Text: "Терпение и вдумчивость.",
		},
		{
			Role: "system",
			Text: "Что Илья считал своим главным достижением?",
		},
		{
			Role: "user",
			Text: "Сохранение старинного сада.",
		},
		{
			Role: "system",
			Text: "Какие истории из молодости Митрофана наиболее запомнились?",
		},
		{
			Role: "user",
			Text: "Сбор народных песен по деревням.",
		},
		{
			Role: "system",
			Text: "Как Митрофан относился к изменениям в жизни?",
		},
		{
			Role: "user",
			Text: "Позитивное восприятие новых возможностей.",
		},
		{
			Role: "system",
			Text: "Какие увлечения Митрофана могли удивить его знакомых?",
		},
		{
			Role: "user",
			Text: "Астрономия.",
		},
		{
			Role: "system",
			Text: "Что для Митрофана значила семья?",
		},
		{
			Role: "user",
			Text: "Опора и вдохновение.",
		},
		{
			Role: "system",
			Text: "Какими мудрыми словами Митрофан любил делиться?",
		},
		{
			Role: "user",
			Text: "Каждая песня — история народа.",
		},
		{
			Role: "system",
			Text: "Что в поведении Митрофана вдохновляло окружающих?",
		},
		{
			Role: "user",
			Text: "Преданность сохранению культурного наследия.",
		},
		{
			Role: "system",
			Text: "Что из детства Бориса Николаевича оказало на него наибольшее влияние?",
		},
		{
			Role: "user",
			Text: "Преодоление трудностей и страсть к спорту.",
		},
		{
			Role: "system",
			Text: "Какие личные качества помогли Борису Николаевичу в жизни?",
		},
		{
			Role: "user",
			Text: "Сильная воля и мужество.",
		},
		{
			Role: "system",
			Text: "Какие моменты в карьере Бориса Николаевича были особенно значимыми?",
		},
		{
			Role: "user",
			Text: "Руководство страной в период перестроек.",
		},
		{
			Role: "system",
			Text: "Какие увлечения у Бориса Николаевича были вне работы?",
		},
		{
			Role: "user",
			Text: "Любовь к теннису.",
		},
		{
			Role: "system",
			Text: "Как Борис Николаевич относился к принятию решений?",
		},
		{
			Role: "user",
			Text: "Решительный и смелый.",
		},
		{
			Role: "system",
			Text: "Что Борис Николаевич считал своим главным достижением?",
		},
		{
			Role: "user",
			Text: "Ведение страны через трансформацию.",
		},
		{
			Role: "system",
			Text: "Какие черты Надежды делали её незабываемой для друзей?",
		},
		{
			Role: "user",
			Text: "Креативность и неиссякаемый энтузиазм.",
		},
		{
			Role: "system",
			Text: "Какие моменты из жизни Надежды вызывают улыбку?",
		},
		{
			Role: "user",
			Text: "Энергичные импровизации на сцене.",
		},
		{
			Role: "system",
			Text: "Как Надежда любила проводить время с семьёй?",
		},
		{
			Role: "user",
			Text: "Обожала семейные праздники с танцами и песнями.",
		},
		{
			Role: "system",
			Text: "Чему Надежда могла научить любого человека?",
		},
		{
			Role: "user",
			Text: "Искусство выражения эмоций через танец.",
		},
		{
			Role: "system",
			Text: "Что Надежда считала своей гордостью?",
		},
		{
			Role: "user",
			Text: "Создание уникального ансамбля и нового жанра.",
		},
		{
			Role: "system",
			Text: "Какие события в жизни Надежды были особенно важны?",
		},
		{
			Role: "user",
			Text: "Основание своего ансамбля.",
		},
		{
			Role: "system",
			Text: "Какой совет Юрий Александрович давал чаще всего?",
		},
		{
			Role: "user",
			Text: "Всегда оставайтесь верными себе.",
		},
		{
			Role: "system",
			Text: "Какие важные события в жизни Юрия оставили отпечаток на его характере?",
		},
		{
			Role: "user",
			Text: "Роли в культовых фильмах и спектаклях.",
		},
		{
			Role: "system",
			Text: "Что Юрий ценил в людях больше всего?",
		},
		{
			Role: "user",
			Text: "Честность и открытость.",
		},
		{
			Role: "system",
			Text: "Какие увлечения были у Юрия?",
		},
		{
			Role: "user",
			Text: "Кинематограф и театр.",
		},
		{
			Role: "system",
			Text: "Как Юрий относился к своим ошибкам и неудачам?",
		},
		{
			Role: "user",
			Text: "Учиться на них, не унывать.",
		},
		{
			Role: "system",
			Text: "Какие традиции Юрий считал важными в своей семье?",
		},
		{
			Role: "user",
			Text: "Вечерние сборы у камина с рассказами.",
		},
		{
			Role: "system",
			Text: "Какие хобби у Елены были наиболее необычными?",
		},
		{
			Role: "user",
			Text: "Коллекционирование винтажных костюмов.",
		},
		{
			Role: "system",
			Text: "Что Елена могла рассказать о своих путешествиях?",
		},
		{
			Role: "user",
			Text: "Рассказы о культурных особенностях посещённых стран.",
		},
		{
			Role: "system",
			Text: "Как Елена выражала свою любовь к близким?",
		},
		{
			Role: "user",
			Text: "Организация семейных праздников.",
		},
		{
			Role: "system",
			Text: "Какие события Елена считала поворотными в своей жизни?",
		},
		{
			Role: "user",
			Text: "Первая главная роль в театре.",
		},
		{
			Role: "system",
			Text: "Чем Елена гордилась в своей жизни?",
		},
		{
			Role: "user",
			Text: "Признание в театральном мире.",
		},
		{
			Role: "system",
			Text: "Какой была мечта Елены, которую она так и не смогла осуществить?",
		},
		{
			Role: "user",
			Text: "Сыграть в кино с мировыми звёздами.",
		},
		{
			Role: "system",
			Text: "Чему Алексей посвящал большую часть своего времени?",
		},
		{
			Role: "user",
			Text: "Изучение и преподавание языков.",
		},
		{
			Role: "system",
			Text: "Какие слова или выражения были фирменными для Алексея?",
		},
		{
			Role: "user",
			Text: "Слово — серебро, молчание — золото.",
		},
		{
			Role: "system",
			Text: "Какой историей из своей жизни Алексей любил делиться?",
		},
		{
			Role: "user",
			Text: "О своём опыте работы переводчиком за границей.",
		},
		{
			Role: "system",
			Text: "Какие черты Алексея вызывали восхищение у его друзей?",
		},
		{
			Role: "user",
			Text: "Эрудиция и остроумие.",
		},
		{
			Role: "system",
			Text: "Что для Алексея значила семья?",
		},
		{
			Role: "user",
			Text: "Семья как основа всего.",
		},
		{
			Role: "system",
			Text: "Какой совет Алексей считал самым важным для передачи молодому поколению?",
		},
		{
			Role: "user",
			Text: "Учитесь на языках мира, чтобы понимать его лучше.",
		},
		{
			Role: "system",
			Text: "Как Амет-Хан относился к своим достижениям?",
		},
		{
			Role: "user",
			Text: "Скромное, сосредоточенное на улучшении навыков.",
		},
		{
			Role: "system",
			Text: "Какие личные истории Амет-Хана наиболее вдохновляющие?",
		},
		{
			Role: "user",
			Text: "О пережитых испытаниях во время полётов.",
		},
		{
			Role: "system",
			Text: "Чему Амет-Хан учил своих детей и внуков?",
		},
		{
			Role: "user",
			Text: "Значение дисциплины и упорства.",
		},
		{
			Role: "system",
			Text: "Какие увлечения Амет-Хана были наиболее неожиданными для его окружения?",
		},
		{
			Role: "user",
			Text: "Садоводство и астрономия.",
		},
		{
			Role: "system",
			Text: "Что Амет-Хан считал своим главным жизненным уроком?",
		},
		{
			Role: "user",
			Text: "Ценность терпения и упорства.",
		},
		{
			Role: "system",
			Text: "Как Амет-Хан предпочитал проводить своё свободное время?",
		},
		{
			Role: "user",
			Text: "Любил наблюдать за звёздами и воспитывать растения.",
		},
		{
			Role: "system",
			Text: "Какие воспоминания о Елене Михайловне наиболее дороги её друзьям?",
		},
		{
			Role: "user",
			Text: "Теплые вечера, проведенные в кругу друзей, обсуждая литературу.",
		},
		{
			Role: "system",
			Text: "Что Елена Михайловна считала своими главными достоинствами?",
		},
		{
			Role: "user",
			Text: "Мудрость, терпимость и доброта.",
		},
		{
			Role: "system",
			Text: "Какие книги Елена Михайловна любила больше всего?",
		},
		{
			Role: "user",
			Text: "Произведения Михаила Булгакова, особенно Мастер и Маргарита.",
		},
		{
			Role: "system",
			Text: "Чему Елена Михайловна стремилась научить своих детей?",
		},
		{
			Role: "user",
			Text: "Значение образования и саморазвития.",
		},
		{
			Role: "system",
			Text: "Какие события в жизни Елены Михайловны были особенно значимыми?",
		},
		{
			Role: "user",
			Text: "Переезд в Новосибирск и преподавание языков.",
		},
		{
			Role: "system",
			Text: "Какие советы Елена Михайловна часто повторяла?",
		},
		{
			Role: "user",
			Text: "Читайте больше, мечтайте смелее.",
		},
		{
			Role: "system",
			Text: "Какие увлечения Игоря Владимировича были наиболее увлекательными?",
		},
		{
			Role: "user",
			Text: "Парусный спорт и подводное плавание.",
		},
		{
			Role: "system",
			Text: "Как Игорь Владимирович относился к новым вызовам и возможностям?",
		},
		{
			Role: "user",
			Text: "Видел в них возможности для роста и самореализации.",
		},
		{
			Role: "system",
			Text: "Какие личные качества Игоря Владимировича наиболее восхищали его окружение?",
		},
		{
			Role: "user",
			Text: "Лидерство, оптимизм и находчивость.",
		},
		{
			Role: "system",
			Text: "Какие события в жизни Игоря оставили наибольший след в его характере?",
		},
		{
			Role: "user",
			Text: "Первое успешное участие в международных регатах.",
		},
		{
			Role: "system",
			Text: "Что Игорь Владимирович считал своим главным достижением?",
		},
		{
			Role: "user",
			Text: "Основание успешной компании по производству яхт.",
		},
		{
			Role: "system",
			Text: "Как Игорь Владимирович предпочитал отдыхать?",
		},
		{
			Role: "user",
			Text: "Время, проведенное на море с семьей.",
		},
		{
			Role: "system",
			Text: "Какие стихотворения Сергея Васильевича были особенно значимы для него самого?",
		},
		{
			Role: "user",
			Text: "Дядя Степа – каждое стихотворение отражало его взгляды и чувство юмора.",
		},
		{
			Role: "system",
			Text: "Какие черты характера Сергея Васильевича помогли ему в его карьере?",
		},
		{
			Role: "user",
			Text: "Непоколебимость, чувство юмора и творческая уникальность.",
		},
		{
			Role: "system",
			Text: "Какие важные моменты из жизни Сергея Васильевича он сам любил вспоминать?",
		},
		{
			Role: "user",
			Text: "Встречи с читателями и детьми, вдохновляющие его на новые произведения.",
		},
		{
			Role: "system",
			Text: "Как Сергей Васильевич относился к своим неудачам и успехам?",
		},
		{
			Role: "user",
			Text: "Спокойное принятие и умение извлекать уроки.",
		},
		{
			Role: "system",
			Text: "Чем Сергей Васильевич любил заниматься в свободное время?",
		},
		{
			Role: "user",
			Text: "Садоводство и коллекционирование редких книг.",
		},
		{
			Role: "system",
			Text: "Какие советы Сергей Васильевич давал молодым писателям?",
		},
		{
			Role: "user",
			Text: "Пишите от сердца, ищите вдохновение в жизни.",
		},
		{
			Role: "system",
			Text: "Какие хобби у Ксении были наиболее необычными?",
		},
		{
			Role: "user",
			Text: "Коллекционирование антикварных украшений.",
		},
		{
			Role: "system",
			Text: "Что Ксения могла рассказать о своих путешествиях?",
		},
		{
			Role: "user",
			Text: "Истории о посещении скрытых уголков Европы.",
		},
		{
			Role: "system",
			Text: "Как Ксения выражала свою любовь к близким?",
		},
		{
			Role: "user",
			Text: "Умение создавать уют и тепло в доме.",
		},
		{
			Role: "system",
			Text: "Какие события Ксения считала поворотными в своей жизни?",
		},
		{
			Role: "user",
			Text: "Обучение и работа в Европе.",
		},
		{
			Role: "system",
			Text: "Какие важные события в жизни Юрия оставили отпечаток на его характере?",
		},
		{
			Role: "user",
			Text: "Роли в культовых фильмах и спектаклях.",
		},
		{
			Role: "system",
			Text: "Что Юрий ценил в людях больше всего?",
		},
		{
			Role: "user",
			Text: "Честность и открытость.",
		},
		{
			Role: "system",
			Text: "Какие увлечения были у Юрия?",
		},
		{
			Role: "user",
			Text: "Кинематограф и театр.",
		},
		{
			Role: "system",
			Text: "Как Юрий относился к своим ошибкам и неудачам?",
		},
		{
			Role: "user",
			Text: "Учиться на них, не унывать.",
		},
		{
			Role: "system",
			Text: "Какие традиции Юрий считал важными в своей семье?",
		},
		{
			Role: "user",
			Text: "Вечерние сборы у камина с рассказами.",
		},
		{
			Role: "system",
			Text: "Какие хобби у Елены были наиболее необычными?",
		},
		{
			Role: "user",
			Text: "Коллекционирование винтажных костюмов.",
		},
		{
			Role: "system",
			Text: "Что Елена могла рассказать о своих путешествиях?",
		},
		{
			Role: "user",
			Text: "Рассказы о культурных особенностях посещённых стран.",
		},
		{
			Role: "system",
			Text: "Как Елена выражала свою любовь к близким?",
		},
		{
			Role: "user",
			Text: "Организация семейных праздников.",
		},
		{
			Role: "system",
			Text: "Какие события Елена считала поворотными в своей жизни?",
		},
		{
			Role: "user",
			Text: "Первая главная роль в театре.",
		},
		{
			Role: "system",
			Text: "Чем Елена гордилась в своей жизни?",
		},
		{
			Role: "user",
			Text: "Признание в театральном мире.",
		},
		{
			Role: "system",
			Text: "Какой была мечта Елены, которую она так и не смогла осуществить?",
		},
		{
			Role: "user",
			Text: "Сыграть в кино с мировыми звёздами.",
		},
		{
			Role: "system",
			Text: "Чему Алексей посвящал большую часть своего времени?",
		},
		{
			Role: "user",
			Text: "Изучение и преподавание языков.",
		},
		{
			Role: "system",
			Text: "Какие слова или выражения были фирменными для Алексея?",
		},
		{
			Role: "user",
			Text: "Слово — серебро, молчание — золото.",
		},
		{
			Role: "system",
			Text: "Какой историей из своей жизни Алексей любил делиться?",
		},
		{
			Role: "user",
			Text: "О своём опыте работы переводчиком за границей.",
		},
		{
			Role: "system",
			Text: "Какие черты Алексея вызывали восхищение у его друзей?",
		},
		{
			Role: "user",
			Text: "Эрудиция и остроумие.",
		},
		{
			Role: "system",
			Text: "Что для Алексея значила семья?",
		},
		{
			Role: "user",
			Text: "Семья как основа всего.",
		},
		{
			Role: "system",
			Text: "Какой совет Алексей считал самым важным для передачи молодому поколению?",
		},
		{
			Role: "user",
			Text: "Учитесь на языках мира, чтобы понимать его лучше.",
		},
		{
			Role: "system",
			Text: "Как Амет-Хан относился к своим достижениям?",
		},
		{
			Role: "user",
			Text: "Скромное, сосредоточенное на улучшении навыков.",
		},
		{
			Role: "system",
			Text: "Какие личные истории Амет-Хана наиболее вдохновляющие?",
		},
		{
			Role: "user",
			Text: "О пережитых испытаниях во время полётов.",
		},
		{
			Role: "system",
			Text: "Чему Амет-Хан учил своих детей и внуков?",
		},
		{
			Role: "user",
			Text: "Значение дисциплины и упорства.",
		},
		{
			Role: "system",
			Text: "Какие увлечения Амет-Хана были наиболее неожиданными для его окружения?",
		},
		{
			Role: "user",
			Text: "Садоводство и астрономия.",
		},
		{
			Role: "system",
			Text: "Что Амет-Хан считал своим главным жизненным уроком?",
		},
		{
			Role: "user",
			Text: "Ценность терпения и упорства.",
		},
		{
			Role: "system",
			Text: "Как Амет-Хан предпочитал проводить своё свободное время?",
		},
		{
			Role: "user",
			Text: "Любил наблюдать за звёздами и воспитывать растения.",
		},
		{
			Role: "system",
			Text: "Какие воспоминания о Елене Михайловне наиболее дороги её друзьям?",
		},
		{
			Role: "user",
			Text: "Теплые вечера, проведенные в кругу друзей, обсуждая литературу.",
		},
		{
			Role: "system",
			Text: "Что Елена Михайловна считала своими главными достоинствами?",
		},
		{
			Role: "user",
			Text: "Мудрость, терпимость и доброта.",
		},
		{
			Role: "system",
			Text: "Какие книги Елена Михайловна любила больше всего?",
		},
		{
			Role: "user",
			Text: "Произведения Михаила Булгакова, особенно Мастер и Маргарита.",
		},
		{
			Role: "system",
			Text: "Чему Елена Михайловна стремилась научить своих детей?",
		},
		{
			Role: "user",
			Text: "Значение образования и саморазвития.",
		},
		{
			Role: "system",
			Text: "Какие события в жизни Елены Михайловны были особенно значимыми?",
		},
		{
			Role: "user",
			Text: "Переезд в Новосибирск и преподавание языков.",
		},
		{
			Role: "system",
			Text: "Какие советы Елена Михайловна часто повторяла?",
		},
		{
			Role: "user",
			Text: "Читайте больше, мечтайте смелее.",
		},
		{
			Role: "system",
			Text: "Какие увлечения Игоря Владимировича были наиболее увлекательными?",
		},
		{
			Role: "user",
			Text: "Парусный спорт и подводное плавание.",
		},
		{
			Role: "system",
			Text: "Как Игорь Владимирович относился к новым вызовам и возможностям?",
		},
		{
			Role: "user",
			Text: "Видел в них возможности для роста и самореализации.",
		},
		{
			Role: "system",
			Text: "Какие личные качества Игоря Владимировича наиболее восхищали его окружение?",
		},
		{
			Role: "user",
			Text: "Лидерство, оптимизм и находчивость.",
		},
		{
			Role: "system",
			Text: "Какие события в жизни Игоря оставили наибольший след в его характере?",
		},
		{
			Role: "user",
			Text: "Первое успешное участие в международных регатах.",
		},
		{
			Role: "system",
			Text: "Что Игорь Владимирович считал своим главным достижением?",
		},
		{
			Role: "user",
			Text: "Основание успешной компании по производству яхт.",
		},
		{
			Role: "system",
			Text: "Как Игорь Владимирович предпочитал отдыхать?",
		},
		{
			Role: "user",
			Text: "Время, проведенное на море с семьей.",
		},
		{
			Role: "system",
			Text: "Какие стихотворения Сергея Васильевича были особенно значимы для него самого?",
		},
		{
			Role: "user",
			Text: "Дядя Степа – каждое стихотворение отражало его взгляды и чувство юмора.",
		},
		{
			Role: "system",
			Text: "Какие черты характера Сергея Васильевича помогли ему в его карьере?",
		},
		{
			Role: "user",
			Text: "Непоколебимость, чувство юмора и творческая уникальность.",
		},
		{
			Role: "system",
			Text: "Какие важные моменты из жизни Сергея Васильевича он сам любил вспоминать?",
		},
		{
			Role: "user",
			Text: "Встречи с читателями и детьми, вдохновляющие его на новые произведения.",
		},
		{
			Role: "system",
			Text: "Как Сергей Васильевич относился к своим неудачам и успехам?",
		},
		{
			Role: "user",
			Text: "Спокойное принятие и умение извлекать уроки.",
		},
		{
			Role: "system",
			Text: "Чем Сергей Васильевич любил заниматься в свободное время?",
		},
		{
			Role: "user",
			Text: "Садоводство и коллекционирование редких книг.",
		},
		{
			Role: "system",
			Text: "Какие советы Сергей Васильевич давал молодым писателям?",
		},
		{
			Role: "user",
			Text: "Пишите от сердца, ищите вдохновение в жизни.",
		},
		{
			Role: "system",
			Text: "Какие хобби у Ксении были наиболее необычными?",
		},
		{
			Role: "user",
			Text: "Коллекционирование антикварных украшений.",
		},
		{
			Role: "system",
			Text: "Что Ксения могла рассказать о своих путешествиях?",
		},
		{
			Role: "user",
			Text: "Истории о посещении скрытых уголков Европы.",
		},
		{
			Role: "system",
			Text: "Как Ксения выражала свою любовь к близким?",
		},
		{
			Role: "user",
			Text: "Умение создавать уют и тепло в доме.",
		},
		{
			Role: "system",
			Text: "Какие события Ксения считала поворотными в своей жизни?",
		},
		{
			Role: "user",
			Text: "Обучение и работа в Европе.",
		},
		{
			Role: "system",
			Text: "Чем Ксения гордилась в своей жизни?",
		},
		{
			Role: "user",
			Text: "Преподавательская деятельность и влияние на студентов.",
		},
		{
			Role: "system",
			Text: "Какой была мечта Ксении, которую она так и не смогла осуществить?",
		},
		{
			Role: "user",
			Text: "Открытие собственной галереи искусств.",
		},
		{
			Role: "system",
			Text: "Чему Лидия Михайловна посвящала большую часть своего времени?",
		},
		{
			Role: "user",
			Text: "Обучение и воспитание детей и внуков.",
		},
		{
			Role: "system",
			Text: "Какие слова или выражения были фирменными для Лидии Михайловны?",
		},
		{
			Role: "user",
			Text: "Всё идет как надо, только терпение.",
		},
		{
			Role: "system",
			Text: "Какой историей из своей жизни Лидия Михайловна любила делиться?",
		},
		{
			Role: "user",
			Text: "Воспоминания о спасении во время блокады Ленинграда.",
		},
		{
			Role: "system",
			Text: "Какие черты Лидии вызывали восхищение у её друзей?",
		},
		{
			Role: "user",
			Text: "Стойкость, мудрость и оптимизм.",
		},
		{
			Role: "system",
			Text: "Что для Лидии значила семья?",
		},
		{
			Role: "user",
			Text: "Семья как крепость и приют.",
		},
		{
			Role: "system",
			Text: "Какой совет Лидия Михайловна считала самым важным для передачи молодому поколению?",
		},
		{
			Role: "user",
			Text: "Цените каждый момент с близкими, это самое важное.",
		},
	}

	reqBodyBytes, _ := json.Marshal(getYandexRequestBody(folderId, "1024", 0.1, extraContext))

	req, _ := http.NewRequest("POST", "https://llm.api.cloud.yandex.net/foundationModels/v1/completion", bytes.NewBuffer(reqBodyBytes))

	req.Header.Set("Authorization", fmt.Sprintf("Api-Key %s", apiKey))
	req.Header.Set("Text-Type", "application/json")
	req.Header.Set("Accept", "*/*")
	req.Header.Set("Connection", "keep-alive")
	req.Header.Set("User-Agent", "PostmanRuntime/7.37.0")

	client := &http.Client{
		Timeout: 30 * time.Second,
	}

	resp, err := client.Do(req)
	if err != nil {
		zap.S().Debugln(err)
		return c.Status(fiber.StatusInternalServerError).JSON(err)
	}
	defer resp.Body.Close()

	body, err := io.ReadAll(resp.Body)
	if err != nil {
		zap.S().Debugln(err)
		return c.Status(fiber.StatusInternalServerError).JSON(err)
	}

	var data yandexResponseData
	err = json.Unmarshal(body, &data)
	if err != nil {
		zap.S().Debugln(err)
		return c.Status(fiber.StatusInternalServerError).JSON(err)
	}

	questionRegex := regexp.MustCompile(`^\d*\.?\s*([А-Я].*\?)$`)
	numberDotRegex := regexp.MustCompile(`^\d+\.\s*`)

	var questions []string
	for _, line := range strings.Split(data.Result.Alternatives[0].Message.Text, "\n") {
		if questionRegex.MatchString(line) {
			cleanLine := numberDotRegex.ReplaceAllString(line, "") // Remove the number and dot at the beginning
			questions = append(questions, cleanLine)
		}
	}

	return c.Status(fiber.StatusOK).JSON(&fiber.Map{
		"response": questions,
	})

}
